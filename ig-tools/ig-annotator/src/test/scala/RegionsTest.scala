import annotators.RegionAnnotator
import common.SequenceType
import org.scalatest.FlatSpec
import org.scalatest.matchers.ShouldMatchers

/**
 * Created with IntelliJ IDEA.
 * User: mactep
 * Date: 01.11.13
 * Time: 15:36
 */
class RegionsTest extends FlatSpec with ShouldMatchers {
  "Region Annotator" should "align right" in {
    val a = new RegionAnnotator("VDJH", SequenceType.NUCLEO, "../../data/train/VDJH_train.fasta", "../../data/train/VDJH_train.kabat")
    val query = "CAGGTGCAGCTGGTGCAGTCTGGGGCTGAGGTGAAGAAGCCTGGGGCCTCAGTGAAGGTCTCCTGCAAGGCTTCTGGATACACCTTCACCGGCTACTATATGCACTGGGTGCGACAGGCCCCTGGACAAGGGCTTGAGTGGATGGGACGGATCAACCCTAACAGTGGTGGCACAAACTATGCACAGAAGTTTCAGGGCAGGGTCACCAGTACCAGGGACACGTCCATCAGCACAGCCTACATGGAGCTGAGCAGGCTGAGATCTGACGACACGGTCGTGTATTACTGTGCGAGAGATAGTAGCTCCCACTATACCCTGAATACTTCCAGCACTGGGGCCAGGGCACCCTGGTCACCGTCTCCTCAG"

    val res = a.alignment(query)
    res.head.score should be (1830)
  }

  it should "annotate right" in {
    val a = new RegionAnnotator("VDJH", SequenceType.NUCLEO, "../../data/train/VDJH_train.fasta", "../../data/train/VDJH_train.kabat")
    val query = "CAGGTGCAGCTGGTGCAGTCTGGGGCTGAGGTGAAGAAGCCTGGGGCCTCAGTGAAGGTCTCCTGCAAGGCTTCTGGATACACCTTCACCGGCTACTATATGCACTGGGTGCGACAGGCCCCTGGACAAGGGCTTGAGTGGATGGGACGGATCAACCCTAACAGTGGTGGCACAAACTATGCACAGAAGTTTCAGGGCAGGGTCACCAGTACCAGGGACACGTCCATCAGCACAGCCTACATGGAGCTGAGCAGGCTGAGATCTGACGACACGGTCGTGTATTACTGTGCGAGAGATAGTAGCTCCCACTATACCCTGAATACTTCCAGCACTGGGGCCAGGGCACCCTGGTCACCGTCTCCTCAG"

    val res = a.annotate(query).foldLeft("")((s, i) => s + i)
    res should be ("000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111222222222222222222222222222222222222222222333333333333333333333333333333333333333333333333333444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555555555555555555555555555555555556666666666666666666666666666666666")
  }
}
