# Primer Design

Цели
----
Есть гуманизированный сиквенс:
`
QLQLQESGGGLVQPGGSLRLSCAASGFTFT RYAMS WVRQAPGKGLEWVS AINSGGGSTYYADSVKG RFTISRDNAKNTVYLQLNSLKTEDMADVLVCRG GGTLGGR
EV  V                        S                                                S   L   M   RA  T   YY
`

Требуется подобрать минимальный набор праймеров, способный при синтезе дать все возможные варианты замен. При этом к праймерам предъявляются следующие условия:
* Проверка на hairpin
* GC контент
* Уникальность праймеров и липких концов - праймеры должны соединяться только с ожидаемыми праймерами, исключая рандомные соединения липких концов

### Простейшая реализация
* Пример лежит в PrintUtilsTest
* `proteinToCodonSets()` - Конвертируем String аминокислот в List[Set[String]], где Set[String] - это множество триплетов для аминокислоты в i-й позиции
* `flattenCodons()` - делаем из List[Set[String]] нуклеотидный Trie такого же типа List[Set[String]], но в 3 раза длиннее. При проходе мы заменем Set[String] с триплетами на 3 Set[String] с множеством нуклеотидов в i-й позиции триплета. Например: `Set("UUU", "UUC", "UUA", "UUG") => List(Set("U"), Set("U"), Set("U", "A", "C", "G"))`
* На выходе получился "почти Trie". Trie - потому что у нас префиксное дерево, в котором i и i + 1 элементы списка соединены ребрами, образуя полный двудольный граф. Почти - потому что есть исключение в виде Leucine - у него 6 триплетов, но из Trie вида List(Set("C", "T"), Set("T"), Set("A", "C", "G", "T")) можно получить 8 триплетов, а должно быть только 6
* `equals()` - сравнивает 2 List[Set[String]]. Равенство будет в случае если в каждой позиции списка находится Set с одним нуклеотидом, одинаковым для обоих списков в данной позиции. Мы не можем получить из двух таких списков разные сиквенсы. Но это становится возможным, если хотя бы в одной позиции одного списка есть выбор хотя бы из двух нуклеотидов
* `findOverlaps()` - разделяет List[Set[String]] на перекрывающиеся группы, проверяя уникальность перекрытий с помощью equals()

### Вывод
см. PrintUtilsTest
Под каждой сплошной строкой праймера в колонках под некоторыми позициями предложены синонимичные замены. Нужно быть аккуратным с лицином, ибо для него не все замены корректны.