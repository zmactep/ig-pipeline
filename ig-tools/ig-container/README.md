Система для точечной аннотации
==============================


1. Загрузка большого числа сиквенсов в контейнер (хранение в сжатом виде - бор + индексирующий массив + массив k-меров)

2. Загрузка аннотаций (таблица records, record: массив букв и соответствующих им аннотаций); 1 record = 1 sequence

3. Алогритмы


Принципы
--------

1. Структура бора не меняется после загрузки данных

2. Аннотации нужны только на последнем этапе, когда найдены пути и требуется получить инфомрацию о каждом узле этих путей

3. Индексирующий массив может содержать любую информацию (ссылки на аннотации/что-то еще)

4. Подмена индексирующего массива стоит О(#узлов) и при бор не знает о его замене


Поиск паттерна в боре
---------------------

1. Подмена индексирующего массива на массив флага цвета

2. Получение всех k-меров искомого паттерна

3. По массиву k-меров получаем все узлы, в которых начинаются полученные k-меры (если какого-то k-мера нет, то нет и паттерна)

4. Окраска в новом индексирующем массиве всех полученных узлов (в порядке их следвоания K-мерам)

5. Для всех последних окрашенных узлов переход по родителю на расстояние (размер паттерна - размер k-мера)

6. Если все узлы, по которым мы прошлись покрашены, то паттерн найден


Выравнивание сиквенса на контейнер
----------------------------------

1. Подмена индексирующего массива на массив, содержащий матрицы частичных выравниваний

2. Выравнивание до развилки, сохранение частичной матрицы в развилках

3. Достраивание матрицы "вниз" по новым веткам, удаление хранящихся частичных матриц при выходе из ветки

4. Сохранение Score и выравнивания в очередь с приоритетами заданного размера


Аннотирование
-------------

1. Выравнивание на ТОП похожих сиквенсов

2. Аннотирование узлов сиквенса консенсусами аннотаций найденных сиквенсов
